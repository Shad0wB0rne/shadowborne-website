<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHADOWBORNE // GRANDMASTER ARSENAL</title>
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/argon2-browser/1.18.0/argon2-bundled.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;800&display=swap');

        /* --- GLOBAL RESET & SCROLLBAR NUKE --- */
        :root {
            --bg-color: #000000;
            --panel-bg: rgba(5, 5, 5, 0.95);
            --cyan: #00f3ff;
            --cyan-dim: rgba(0, 243, 255, 0.15);
            --red: #ff003c;
            --red-dim: rgba(255, 0, 60, 0.15);
            --neon-shadow: 0 0 10px;
        }

        /* INVISIBLE SCROLLBARS (Global) */
        html, body, div, textarea, .custom-options {
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* IE/Edge */
        }
        ::-webkit-scrollbar { 
            display: none; /* Chrome/Safari */
        }

        body { 
            background-color: var(--bg-color); 
            color: #e5e5e5; 
            font-family: 'JetBrains Mono', monospace; 
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* --- VISUAL FX --- */
        .cyber-font { font-family: 'JetBrains Mono', monospace; letter-spacing: -2px; }
        
        .crt-flicker { animation: flicker 0.15s infinite; pointer-events: none; position: fixed; inset: 0; background: rgba(18, 16, 16, 0.02); z-index: 40; }
        @keyframes flicker {
            0%, 100% { opacity: 0.97; } 50% { opacity: 0.95; }
        }

        .scanline {
            width: 100vw; height: 100vh; position: fixed; top: 0; left: 0; z-index: 50;
            background: linear-gradient(0deg, rgba(0,0,0,0) 0%, rgba(0, 243, 255, 0.02) 50%, rgba(0,0,0,0) 100%);
            opacity: 0.5; animation: scan 6s linear infinite; pointer-events: none;
        }
        @keyframes scan { 0% { transform: translateY(-100%); } 100% { transform: translateY(100%); } }

        .bg-grid {
            position: fixed; inset: 0; z-index: 0; pointer-events: none;
            background-image: linear-gradient(to right, rgba(30, 30, 30, 0.5) 1px, transparent 1px),
                              linear-gradient(to bottom, rgba(30, 30, 30, 0.5) 1px, transparent 1px);
            background-size: 30px 30px;
            mask-image: radial-gradient(circle at center, black 40%, transparent 100%);
        }

        /* --- CARDS --- */
        .cyber-card {
            background: var(--panel-bg); border: 1px solid #1a1a1a;
            position: relative; display: flex; flex-direction: column;
            transition: all 0.3s ease; box-shadow: 0 0 20px rgba(0,0,0,0.8); z-index: 10;
        }
        
        .corner { position: absolute; width: 10px; height: 10px; transition: all 0.3s ease; opacity: 0.7; pointer-events: none; z-index: 20; }
        .cyber-card:hover .corner { width: 100%; height: 100%; opacity: 1; }
        .tl { top: -1px; left: -1px; border-top: 2px solid; border-left: 2px solid; }
        .br { bottom: -1px; right: -1px; border-bottom: 2px solid; border-right: 2px solid; }

        /* THEMES */
        .theme-cyan:hover { border-color: var(--cyan); box-shadow: 0 0 40px var(--cyan-dim); }
        .theme-cyan .corner { border-color: var(--cyan); }
        .theme-cyan .input-box:focus { border-color: var(--cyan); box-shadow: inset 0 0 15px var(--cyan-dim); color: var(--cyan); }
        .theme-cyan .action-btn:hover { background: var(--cyan); color: #000; box-shadow: 0 0 20px var(--cyan); }

        .theme-red:hover { border-color: var(--red); box-shadow: 0 0 40px var(--red-dim); }
        .theme-red .corner { border-color: var(--red); }
        .theme-red .input-box:focus { border-color: var(--red); box-shadow: inset 0 0 15px var(--red-dim); color: var(--red); }
        .theme-red .action-btn:hover { background: var(--red); color: #fff; box-shadow: 0 0 20px var(--red); }

        /* --- CONTROLS --- */
        .input-box {
            width: 100%; background: #0a0a0a; border: 1px solid #333;
            padding: 1rem; font-family: 'JetBrains Mono', monospace; font-size: 0.75rem;
            color: #888; transition: all 0.3s; outline: none; position: relative; z-index: 30;
        }

        .action-btn {
            width: 100%; padding: 1rem; font-weight: 800; text-transform: uppercase;
            letter-spacing: 2px; border: 1px solid; background: transparent;
            transition: all 0.2s; cursor: pointer; font-size: 0.75rem;
            margin-top: 1rem; position: relative; z-index: 30;
        }
        
        .console-out {
            background: #000; border: 1px solid #111; padding: 1rem;
            font-size: 0.7rem; color: #aaa; height: 250px; overflow-y: auto;
            margin-top: 1rem; font-family: 'JetBrains Mono', monospace;
            border-left: 2px solid #333; position: relative; z-index: 30;
        }

        /* --- CUSTOM CYBER DROPDOWN --- */
        .custom-select-wrapper { position: relative; user-select: none; width: 100%; z-index: 50; }
        
        .custom-select-trigger {
            position: relative; display: flex; align-items: center; justify-content: space-between;
            padding: 1rem; font-size: 0.7rem; font-weight: bold; color: #666;
            background: #0a0a0a; border: 1px solid #333; cursor: pointer; transition: all 0.3s;
        }
        .custom-select-trigger:hover { border-color: var(--red); color: var(--red); }
        
        .custom-options {
            position: absolute; display: block; top: 100%; left: 0; right: 0;
            border: 1px solid var(--red); border-top: 0; background: #000;
            transition: all 0.3s; opacity: 0; visibility: hidden; pointer-events: none;
            transform: translateY(-10px); max-height: 200px; overflow-y: auto;
        }
        
        .custom-select.open .custom-options { opacity: 1; visibility: visible; pointer-events: all; transform: translateY(0); }
        .custom-select.open .custom-select-trigger { border-color: var(--red); color: var(--red); }
        
        .option {
            position: relative; display: block; padding: 0.8rem 1rem; font-size: 0.7rem;
            color: #888; cursor: pointer; transition: all 0.2s; border-bottom: 1px solid #111;
        }
        .option:hover { background: var(--red); color: #fff; padding-left: 1.5rem; }
        .option.selected { color: var(--red); font-weight: bold; }

        .arrow { width: 0; height: 0; border-left: 5px solid transparent; border-right: 5px solid transparent; border-top: 5px solid #666; transition: 0.3s; }
        .custom-select.open .arrow { transform: rotate(180deg); border-top-color: var(--red); }

        /* GLOW BTN */
        .glow-btn {
            background: #000; border: 1px solid var(--red); color: var(--red);
            padding: 0.5rem 1rem; font-size: 0.7rem; font-weight: bold; cursor: pointer;
            transition: all 0.3s; text-align: center; width: 100%; display: block; position: relative; z-index: 30;
        }
        .glow-btn:hover { background: var(--red); color: white; box-shadow: 0 0 15px var(--red); }

        .label-text { font-size: 0.6rem; color: #555; letter-spacing: 0.1em; margin-bottom: 0.5rem; display: block; position: relative; z-index: 30; }
        .nav-btn {
            border: 1px solid #333; padding: 10px 30px; font-size: 0.7rem;
            color: #666; transition: 0.3s; text-decoration: none; position: relative; z-index: 30;
        }
        .nav-btn:hover { border-color: var(--red); color: var(--red); box-shadow: 0 0 15px var(--red-dim); }

    </style>
</head>
<body>

    <canvas id="canvas" class="fixed inset-0 z-0 opacity-30 pointer-events-none"></canvas>
    <div class="bg-grid"></div>
    <div class="scanline"></div>
    <div class="crt-flicker"></div>

    <div class="relative z-20 max-w-7xl mx-auto p-6 md:p-12">
        
        <header class="flex flex-col md:flex-row justify-between items-end mb-16 border-b border-gray-900 pb-8">
            <div>
                <h1 class="text-5xl md:text-7xl font-black text-white cyber-font tracking-tighter mb-2">
                    DIGITAL <span style="color: var(--red); text-shadow: 0 0 25px rgba(255,0,60,0.6);">ARSENAL</span>
                </h1>
                <div class="flex flex-wrap items-center gap-6 text-[10px] tracking-[0.2em] text-gray-600 uppercase font-bold">
                    <span><span class="inline-block w-2 h-2 rounded-full bg-[#00f3ff] mr-2 shadow-[0_0_10px_#00f3ff]"></span>SYSTEM_OVERRIDE</span>
                    <span>// VER: 3.5.0</span>
                    <span>// MODE: GRANDMASTER</span>
                </div>
            </div>
            <a href="index.html" class="nav-btn mt-6 md:mt-0">
                &lt; RETURN_TO_ROOT
            </a>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">

            <div class="cyber-card theme-cyan p-8 group">
                <div class="corner tl"></div><div class="corner br"></div>
                
                <div class="flex justify-between items-center mb-6 relative z-30">
                    <h2 class="text-2xl font-bold text-white flex items-center gap-3">
                        <span class="w-1 h-6 bg-[#00f3ff] shadow-[0_0_15px_#00f3ff]"></span>
                        HASH_ID_ENGINE
                    </h2>
                    <span class="text-[#00f3ff] text-[9px] tracking-widest opacity-70 border border-[#00f3ff] px-2 py-1">HASHCAT_DB</span>
                </div>

                <div class="flex-grow flex flex-col">
                    <label class="label-text">> INPUT_STREAM (ONE PER LINE)</label>
                    <textarea id="hashInput" class="input-box h-40" 
                        placeholder="5f4dcc3b5aa765d61d8327deb882cf99&#10;$argon2id$v=19$m=65536,t=3,p=4$..."></textarea>
                    
                    <div class="flex gap-4 mt-4">
                        <button id="btnAnalyze" class="action-btn text-[#00f3ff] border-[#00f3ff] flex-grow mt-0">
                            RUN_DIAGNOSTIC
                        </button>
                        <button id="btnDownload" class="action-btn border-gray-700 text-gray-500 hover:text-white hover:border-white w-auto px-6 mt-0 hidden">
                            SAVE_LOG
                        </button>
                    </div>
                    
                    <div id="consoleOutput" class="console-out">
                        <div class="text-[#333] animate-pulse">// SYSTEM_READY... AWAITING DATA</div>
                    </div>
                </div>
            </div>

            <div class="cyber-card theme-red p-8 group">
                <div class="corner tl"></div><div class="corner br"></div>

                <div class="flex justify-between items-center mb-6 relative z-30">
                    <h2 class="text-2xl font-bold text-white flex items-center gap-3">
                        <span class="w-1 h-6 bg-[#ff003c] shadow-[0_0_15px_#ff003c]"></span>
                        ARGON2_FORGE
                    </h2>
                    <span class="text-[#ff003c] text-[9px] tracking-widest opacity-70 border border-[#ff003c] px-2 py-1">WASM_CORE</span>
                </div>
                
                <div class="flex-grow flex flex-col gap-6">
                    <div>
                        <label class="label-text">> PASSWORD_INPUT</label>
                        <input type="text" id="argonInput" class="input-box" placeholder="Enter cleartext password">
                    </div>

                    <div class="custom-select-wrapper">
                        <label class="label-text">> CONFIGURATION_PRESET</label>
                        <div class="custom-select" id="argPresetSelect">
                            <div class="custom-select-trigger">
                                <span id="presetText">OWASP / RFC 9106 (Standard)</span>
                                <div class="arrow"></div>
                            </div>
                            <div class="custom-options">
                                <span class="option selected" data-value="65536,3,4">OWASP / RFC 9106 (Standard)</span>
                                <span class="option" data-value="262144,4,4">Browser Hardened (256MB)</span>
                                <span class="option" data-value="19456,3,1">IoT / Mobile (Low Memory)</span>
                                <span class="option" data-value="1048576,1,4">Paranoid Mode (1GB RAM)</span>
                            </div>
                        </div>
                    </div>

                    <input type="hidden" id="argMem" value="65536">
                    <input type="hidden" id="argTime" value="3">
                    <input type="hidden" id="argPara" value="4">

                    <button id="btnGenerate" class="action-btn text-[#ff003c] border-[#ff003c]">
                        INITIALIZE_HASHING
                    </button>

                    <div id="argonResult" class="hidden transition-all duration-500 border-t border-gray-900 pt-6">
                         <label class="label-text block text-[#ff003c]">> GENERATED_HASH_OUTPUT</label>
                         <textarea id="argonOutput" readonly class="input-box h-24 bg-black text-gray-400 border-gray-800 break-all mb-4"></textarea>
                         
                         <button id="btnCopyArgon" class="glow-btn">
                             COPY_TO_CLIPBOARD
                         </button>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- 1. PARTICLE PHYSICS ENGINE ---
            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');
            let width, height;
            let particles = [];

            function resize() { width = canvas.width = window.innerWidth; height = canvas.height = window.innerHeight; }
            window.addEventListener('resize', resize);
            resize();

            class Particle {
                constructor() {
                    this.x = Math.random() * width; this.y = Math.random() * height;
                    this.vx = (Math.random() - 0.5) * 0.2; this.vy = (Math.random() - 0.5) * 0.2;
                    this.size = Math.random() * 2;
                    this.color = Math.random() > 0.5 ? '#00f3ff' : '#ff003c'; 
                }
                update() {
                    this.x += this.vx; this.y += this.vy;
                    if (this.x < 0 || this.x > width) this.vx *= -1;
                    if (this.y < 0 || this.y > height) this.vy *= -1;
                }
                draw() {
                    ctx.fillStyle = this.color; ctx.globalAlpha = 0.3; ctx.beginPath();
                    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2); ctx.fill();
                }
            }
            for (let i = 0; i < 40; i++) particles.push(new Particle());

            function animate() {
                ctx.clearRect(0, 0, width, height);
                particles.forEach((p, i) => {
                    p.update(); p.draw();
                    for (let j = i + 1; j < particles.length; j++) {
                        const p2 = particles[j];
                        const dist = Math.sqrt((p.x - p2.x)**2 + (p.y - p2.y)**2);
                        if (dist < 100) {
                            ctx.strokeStyle = `rgba(50, 50, 50, ${0.1 - (dist/100)*0.1})`;
                            ctx.lineWidth = 1; ctx.beginPath(); ctx.moveTo(p.x, p.y); ctx.lineTo(p2.x, p2.y); ctx.stroke();
                        }
                    }
                });
                requestAnimationFrame(animate);
            }
            animate();

            // --- 2. DROPDOWN LOGIC ---
            const wrapper = document.querySelector('.custom-select-wrapper');
            const select = wrapper.querySelector('.custom-select');
            const options = wrapper.querySelectorAll('.option');
            const trigger = wrapper.querySelector('.custom-select-trigger');
            const presetText = document.getElementById('presetText');

            trigger.addEventListener('click', () => {
                select.classList.toggle('open');
            });

            options.forEach(option => {
                option.addEventListener('click', function() {
                    select.classList.remove('open');
                    options.forEach(o => o.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    presetText.textContent = this.textContent;
                    
                    // Parse Data
                    const [mem, time, para] = this.getAttribute('data-value').split(',');
                    document.getElementById('argMem').value = mem;
                    document.getElementById('argTime').value = time;
                    document.getElementById('argPara').value = para;
                });
            });

            window.addEventListener('click', (e) => {
                if (!select.contains(e.target)) {
                    select.classList.remove('open');
                }
            });

            // --- 3. HASH ANALYZER (GRANDMASTER v3.1) ---
            const HASH_LIB = [
                // PREFIX BASED (Highest Accuracy)
                { name: "[0500] md5crypt, MD5 (Unix)", prefix: "$1$" },
                { name: "[3200] bcrypt $2*", prefix: ["$2a$", "$2y$", "$2b$", "$2x$"] },
                { name: "[7400] sha256crypt $5$", prefix: "$5$" },
                { name: "[1800] sha512crypt $6$", prefix: "$6$" },
                { name: "[1600] Apache $apr1$ MD5", prefix: "$apr1$" },
                { name: "[10001] Argon2 (Generic)", prefix: ["$argon2id$", "$argon2i$", "$argon2d$"] },
                { name: "[10000] Django (PBKDF2-SHA256)", prefix: "pbkdf2_sha256$" },
                { name: "[10900] PBKDF2-HMAC-SHA256", prefix: "$pbkdf2-sha256$" },
                { name: "[5500] NetNTLMv1", prefix: "$NETNTLM$" },
                { name: "[2100] DCC2 (MSCash)", prefix: "$DCC2$" },
                { name: "[7500] Kerberos 5 AS-REQ", prefix: "$krb5pa$23$" },
                { name: "[13100] Kerberos 5 TGS-REP", prefix: "$krb5tgs$23$" },
                { name: "[400] WordPress / PHPass", prefix: ["$P$", "$H$"] },
                { name: "[7900] Drupal 7", prefix: "$S$" },
                { name: "[10500] PDF 1.4 - 1.6", prefix: "$pdf$" },
                { name: "[11300] Bitcoin/Litecoin Wallet", prefix: "$bitcoin$" },
                { name: "[13600] WinZip", prefix: "$zip2$" },
                { name: "[11600] 7-Zip", prefix: "$7z$" },
                { name: "[1710] PostgreSQL MD5", prefix: "md5" },
                { name: "[132] MSSQL (2005)", prefix: "0x0100" },
                
                // REGEX / PATTERN BASED
                { name: "[5600] NetNTLMv2", regex: /^[\w\-\.]*::[\w\-\.]*:[a-fA-F0-9]{16}:[a-fA-F0-9]+/ },
                { name: "[300] MySQL 4.1/5+", regex: /^\*[0-9A-F]{40}$/i },
                
                // GENERIC CHECKSUMS (Fallback)
                { name: "[100] SHA1", length: 40, regex: /^[0-9a-fA-F]{40}$/i },
                { name: "[1400] SHA-256", length: 64, regex: /^[0-9a-fA-F]{64}$/i },
                { name: "[1700] SHA-512", length: 128, regex: /^[0-9a-fA-F]{128}$/i },
                { name: "MD5 (Generic) / NTLM", length: 32, regex: /^[0-9a-fA-F]{32}$/i }
            ];

            const btnAnalyze = document.getElementById('btnAnalyze');
            const btnDownload = document.getElementById('btnDownload');
            let lastReport = "";

            btnAnalyze.addEventListener('click', () => {
                const rawText = document.getElementById('hashInput').value.trim();
                const consoleOutput = document.getElementById('consoleOutput');
                
                if (!rawText) return;
                
                const lines = rawText.split(/\r?\n/);
                consoleOutput.innerHTML = ""; 
                lastReport = "SHADOWBORNE DIAGNOSTIC REPORT\n" + new Date().toISOString() + "\n--------------------------------\n";
                let foundCount = 0;

                lines.forEach((line, index) => {
                    line = line.trim();
                    if (!line) return;
                    foundCount++;
                    let matches = [];
                    
                    HASH_LIB.forEach(rule => {
                        let isMatch = false;
                        if (rule.prefix) {
                            if (Array.isArray(rule.prefix)) { if (rule.prefix.some(p => line.startsWith(p))) isMatch = true; }
                            else { if (line.startsWith(rule.prefix)) isMatch = true; }
                        } else if (rule.regex) { if (rule.regex.test(line)) isMatch = true; }
                        
                        // Fallback: Length Check
                        if (!isMatch && rule.length && line.length === rule.length && rule.regex.test(line)) {
                            isMatch = true;
                        }

                        if (isMatch) matches.push(rule.name);
                    });

                    const lineNum = (index + 1).toString().padStart(2, '0');
                    const trunc = line.length > 20 ? line.substring(0, 20) + "..." : line;
                    
                    let logLine = "";
                    if (matches.length > 0) {
                        const unique = [...new Set(matches)]; 
                        const resultStr = unique.join(' OR ');
                        consoleOutput.innerHTML += `<div class="border-b border-gray-900 pb-1 mb-1 hover:bg-[#111] transition-colors flex justify-between"><span class="text-gray-600 font-bold">[${lineNum}]</span> <span class="text-gray-500">${trunc}</span> <span class="text-[#00f3ff] text-right">>> ${resultStr}</span></div>`;
                        logLine = `[${lineNum}] ${line} >> DETECTED: ${resultStr}`;
                    } else {
                        consoleOutput.innerHTML += `<div class="border-b border-gray-900 pb-1 mb-1 opacity-50 flex justify-between"><span class="text-gray-600">[${lineNum}]</span> <span class="text-gray-600">${trunc}</span> <span class="text-[#ff003c] text-right">>> UNKNOWN</span></div>`;
                        logLine = `[${lineNum}] ${line} >> UNKNOWN_FORMAT`;
                    }
                    lastReport += logLine + "\n";
                });

                if (foundCount > 0) {
                    btnDownload.classList.remove('hidden');
                }
            });

            btnDownload.addEventListener('click', () => {
                const blob = new Blob([lastReport], { type: "text/plain" });
                const url = URL.createObjectURL(blob);
                const a = document.createElement("a");
                a.href = url;
                a.download = "shadowborne_hash_report.txt";
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            });

            // --- 4. ARGON2 GENERATOR ---
            const btnGenerate = document.getElementById('btnGenerate');
            btnGenerate.addEventListener('click', async () => {
                const password = document.getElementById('argonInput').value;
                const output = document.getElementById('argonOutput');
                const resultDiv = document.getElementById('argonResult');
                
                // Get Hidden Params (From Dropdown)
                const mem = parseInt(document.getElementById('argMem').value) || 65536;
                const time = parseInt(document.getElementById('argTime').value) || 3;
                const para = parseInt(document.getElementById('argPara').value) || 4;

                if (!password) { alert("INPUT REQUIRED"); return; }

                btnGenerate.innerText = "CALCULATING...";
                btnGenerate.style.opacity = "0.5";

                try {
                    const hash = await argon2.hash({
                        pass: password, 
                        salt: 'shadowbornesalt123',
                        time: time, 
                        mem: mem,
                        hashLen: 32, 
                        parallelism: para, 
                        type: argon2.ArgonType.Argon2id
                    });
                    
                    output.value = hash.encoded;
                    resultDiv.classList.remove('hidden');
                    btnGenerate.innerText = "EXECUTE_HASHING_ALGORITHM";
                    btnGenerate.style.opacity = "1";
                } catch (e) {
                    output.value = "ERROR: " + e.message;
                    resultDiv.classList.remove('hidden');
                    btnGenerate.innerText = "EXECUTE_HASHING_ALGORITHM";
                    btnGenerate.style.opacity = "1";
                }
            });

            const btnCopy = document.getElementById('btnCopyArgon');
            btnCopy.addEventListener('click', () => {
                const el = document.getElementById('argonOutput');
                el.select();
                document.execCommand('copy');
                const originalText = btnCopy.innerText;
                btnCopy.innerText = "HASH_COPIED";
                btnCopy.style.background = "#ff003c";
                btnCopy.style.color = "white";
                setTimeout(() => {
                    btnCopy.innerText = originalText;
                    btnCopy.style.background = "black";
                    btnCopy.style.color = "#ff003c";
                }, 2000);
            });
        });
    </script>
</body>
</html>
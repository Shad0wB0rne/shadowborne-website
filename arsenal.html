<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHADOWBORNE // ARSENAL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;800&display=swap');
        
        body { 
            background-color: #050505; 
            color: #e5e5e5; 
            font-family: 'JetBrains Mono', monospace; 
            overflow-x: hidden;
        }

        .cyber-font { font-family: 'JetBrains Mono', monospace; letter-spacing: -2px; }
        
        /* SCROLLBAR */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0a0a0a; }
        ::-webkit-scrollbar-thumb { background: #333; border: 1px solid #000; }
        ::-webkit-scrollbar-thumb:hover { background: #00f3ff; }

        /* CRT EFFECT */
        .scanline {
            width: 100%; height: 100px; z-index: 5;
            background: linear-gradient(0deg, rgba(0,0,0,0) 0%, rgba(0, 243, 255, 0.03) 50%, rgba(0,0,0,0) 100%);
            opacity: 0.5; position: absolute; bottom: 100%;
            animation: scanline 8s linear infinite; pointer-events: none;
        }
        @keyframes scanline { 0% { bottom: 100%; } 100% { bottom: -100%; } }

        /* BACKGROUND GRID */
        .bg-grid {
            background-size: 40px 40px;
            background-image: 
                linear-gradient(to right, rgba(255, 255, 255, 0.03) 1px, transparent 1px),
                linear-gradient(to bottom, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
            position: fixed; inset: 0; z-index: 0; pointer-events: none;
            mask-image: radial-gradient(circle at center, black 40%, transparent 100%);
        }

        /* GLITCH ANIMATION FOR HOVER */
        @keyframes glitch-skew {
            0% { transform: skew(0deg); }
            20% { transform: skew(-2deg); }
            40% { transform: skew(2deg); }
            60% { transform: skew(-1deg); }
            80% { transform: skew(1deg); }
            100% { transform: skew(0deg); }
        }
        .hover-glitch:hover { animation: glitch-skew 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94) both infinite; }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/argon2-browser/1.18.0/argon2-bundled.min.js"></script>
</head>
<body class="min-h-screen relative selection:bg-[#ff003c] selection:text-white">

    <canvas id="canvas" class="fixed inset-0 z-0 opacity-40 pointer-events-none"></canvas>
    <div class="bg-grid"></div>
    <div class="scanline"></div>
    <div class="fixed inset-0 bg-[radial-gradient(circle_at_center,transparent_0%,#000000_120%)] z-0 pointer-events-none"></div>

    <div class="relative z-20 p-8">
        
        <header class="flex flex-col md:flex-row justify-between items-end mb-12 border-b border-gray-800 pb-6">
            <div>
                <h1 class="text-4xl md:text-6xl font-black text-white cyber-font mb-2 drop-shadow-[0_0_15px_rgba(255,255,255,0.2)]">
                    DIGITAL <span class="text-[#ff003c] drop-shadow-[0_0_15px_rgba(255,0,60,0.5)]">ARSENAL</span>
                </h1>
                <div class="flex gap-4 text-[10px] text-gray-500 font-mono uppercase tracking-widest">
                    <span class="flex items-center gap-2"><span class="w-1.5 h-1.5 bg-[#00f3ff] rounded-full animate-pulse"></span> SYS_READY</span>
                    <span>>> DB_ENTRIES: 60+</span>
                </div>
            </div>
            <a href="index.html" class="mt-4 md:mt-0 px-6 py-2 border border-gray-800 bg-black/50 hover:border-[#ff003c] hover:bg-[#ff003c]/10 text-[#ff003c] text-xs font-mono transition-all duration-300 hover-glitch">
                < RETURN_TO_ROOT
            </a>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 max-w-7xl mx-auto">

            <div class="bg-[#0a0a0a]/80 backdrop-blur-sm border border-gray-800 p-8 flex flex-col h-[600px] relative group hover:border-[#00f3ff] transition-all duration-500 shadow-[0_0_30px_rgba(0,0,0,0.5)]">
                <div class="absolute -top-[1px] -left-[1px] w-4 h-4 border-t border-l border-[#00f3ff] opacity-0 group-hover:opacity-100 transition-opacity"></div>
                <div class="absolute -bottom-[1px] -right-[1px] w-4 h-4 border-b border-r border-[#00f3ff] opacity-0 group-hover:opacity-100 transition-opacity"></div>
                
                <div class="absolute top-0 right-0 p-3 text-[#00f3ff] opacity-50 font-mono text-[10px] tracking-widest">MULTI_TARGET_ENABLED</div>
                <h2 class="text-2xl font-bold text-white mb-4 flex items-center gap-3 shrink-0">
                    <span class="w-3 h-3 bg-[#00f3ff] shadow-[0_0_10px_#00f3ff]"></span>
                    HASH_ANALYZER
                </h2>

                <div class="flex flex-col flex-grow min-h-0 space-y-4">
                    
                    <div class="shrink-0">
                        <label class="text-[10px] text-gray-500 font-mono block mb-2 tracking-widest">> INPUT_HASHES (ONE PER LINE)</label>
                        <textarea id="hashInput" 
                            class="w-full h-32 bg-black/50 border border-gray-800 text-[#00f3ff] font-mono p-4 focus:outline-none focus:border-[#00f3ff] transition-colors placeholder-gray-800 text-xs resize-none"
                            placeholder="Paste hashes here...&#10;5f4dcc3b5aa765d61d8327deb882cf99&#10;$2a$12$R9h/cIPz0gi.URNNX3kh2OPST9/PgBkBr1zkzEz"></textarea>
                    </div>

                    <div class="flex gap-2 shrink-0">
                        <button id="btnAnalyze" class="flex-grow bg-[#00f3ff]/5 border border-[#00f3ff]/30 text-[#00f3ff] font-bold font-mono py-2 hover:bg-[#00f3ff] hover:text-black transition-all text-xs hover:shadow-[0_0_15px_rgba(0,243,255,0.4)]">
                            RUN_ANALYSIS
                        </button>
                        <button id="btnDownload" class="px-4 border border-gray-700 text-gray-400 hover:text-white hover:border-white transition-all text-xs hidden">
                            SAVE_LOG
                        </button>
                    </div>

                    <div id="consoleOutput" class="flex-1 min-h-0 bg-black/80 border border-gray-800 p-4 font-mono text-xs overflow-y-auto space-y-1 shadow-inner scrollbar-thin scrollbar-thumb-gray-700 scrollbar-track-transparent">
                        <div class="text-gray-600 animate-pulse">// SYSTEM_READY... AWAITING INPUT</div>
                    </div>
                </div>
            </div>

            <div class="bg-[#0a0a0a]/80 backdrop-blur-sm border border-gray-800 p-8 flex flex-col h-[600px] relative group hover:border-[#ff003c] transition-all duration-500 shadow-[0_0_30px_rgba(0,0,0,0.5)]">
                <div class="absolute -top-[1px] -left-[1px] w-4 h-4 border-t border-l border-[#ff003c] opacity-0 group-hover:opacity-100 transition-opacity"></div>
                <div class="absolute -bottom-[1px] -right-[1px] w-4 h-4 border-b border-r border-[#ff003c] opacity-0 group-hover:opacity-100 transition-opacity"></div>

                <div class="absolute top-0 right-0 p-3 text-[#ff003c] opacity-50 font-mono text-[10px] tracking-widest">WASM_CORE</div>
                <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-3 shrink-0">
                    <span class="w-3 h-3 bg-[#ff003c] shadow-[0_0_10px_#ff003c]"></span>
                    ARGON2_GENERATOR
                </h2>
                
                <div class="space-y-6">
                    <div>
                        <label class="text-[10px] text-gray-500 font-mono block mb-2 tracking-widest">> INPUT_CLEAR_TEXT</label>
                        <input type="text" id="argonInput" 
                            class="w-full bg-black/50 border border-gray-800 text-[#ff003c] font-mono p-4 focus:outline-none focus:border-[#ff003c] transition-colors placeholder-gray-800"
                            placeholder="Enter password to hash">
                    </div>

                    <div class="grid grid-cols-3 gap-2 text-[10px] font-mono text-gray-500">
                        <div class="border border-gray-800 p-2 text-center bg-black/30">MEM: 64MB</div>
                        <div class="border border-gray-800 p-2 text-center bg-black/30">ITER: 4</div>
                        <div class="border border-gray-800 p-2 text-center bg-black/30">TYPE: Argon2id</div>
                    </div>

                    <button id="btnGenerate" class="w-full bg-[#ff003c]/5 border border-[#ff003c]/30 text-[#ff003c] font-bold font-mono py-3 hover:bg-[#ff003c] hover:text-white transition-all hover:shadow-[0_0_15px_rgba(255,0,60,0.4)]">
                        EXECUTE_HASHING_ALGORITHM
                    </button>

                    <div id="argonResult" class="hidden">
                         <label class="text-[10px] text-gray-500 font-mono block mb-2 tracking-widest">> OUTPUT_HASH</label>
                         <div class="relative group/copy">
                            <textarea id="argonOutput" readonly class="w-full h-32 bg-black/50 border border-gray-800 text-gray-400 font-mono text-xs p-4 pr-32 focus:outline-none resize-none break-all"></textarea>
                            <div class="absolute top-0 right-0 h-full w-24 bg-gradient-to-l from-black to-transparent pointer-events-none"></div>
                            <div class="absolute top-2 right-2 border border-[#ff003c] text-[#ff003c] text-[9px] px-2 py-1 opacity-50 group-hover/copy:opacity-100 transition-opacity cursor-pointer bg-black" id="btnCopyArgon">
                                CLICK_TO_COPY
                            </div>
                         </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        // --- PARTICLE SYSTEM (CYBER NODES) ---
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let width, height;
        let particles = [];

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        class Particle {
            constructor() {
                this.x = Math.random() * width;
                this.y = Math.random() * height;
                this.vx = (Math.random() - 0.5) * 0.5;
                this.vy = (Math.random() - 0.5) * 0.5;
                this.size = Math.random() * 2;
                this.color = Math.random() > 0.5 ? '#00f3ff' : '#ff003c'; // Cyan or Red
            }
            update() {
                this.x += this.vx;
                this.y += this.vy;
                if (this.x < 0 || this.x > width) this.vx *= -1;
                if (this.y < 0 || this.y > height) this.vy *= -1;
            }
            draw() {
                ctx.fillStyle = this.color;
                ctx.globalAlpha = 0.5;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        for (let i = 0; i < 50; i++) particles.push(new Particle());

        function animate() {
            ctx.clearRect(0, 0, width, height);
            
            // Draw connections
            particles.forEach((p, i) => {
                p.update();
                p.draw();
                // Connect near particles
                for (let j = i + 1; j < particles.length; j++) {
                    const p2 = particles[j];
                    const dx = p.x - p2.x;
                    const dy = p.y - p2.y;
                    const dist = Math.sqrt(dx*dx + dy*dy);
                    if (dist < 150) {
                        ctx.strokeStyle = 'rgba(100, 100, 100, 0.1)';
                        ctx.lineWidth = 1;
                        ctx.beginPath();
                        ctx.moveTo(p.x, p.y);
                        ctx.lineTo(p2.x, p2.y);
                        ctx.stroke();
                    }
                }
            });
            requestAnimationFrame(animate);
        }
        animate();

        // --- COPY FUNCTIONALITY FIX ---
        document.getElementById('btnCopyArgon').addEventListener('click', () => {
            const argonOutput = document.getElementById('argonOutput');
            argonOutput.select();
            document.execCommand('copy');
            const originalText = document.getElementById('btnCopyArgon').innerText;
            document.getElementById('btnCopyArgon').innerText = "COPIED!";
            setTimeout(() => {
                document.getElementById('btnCopyArgon').innerText = originalText;
            }, 2000);
        });

        // --- HASH LOGIC (EXPANDED LIBRARY) ---
        const HASH_LIB = [
            { name: "MD5-Crypt ($1$)", prefix: "$1$" },
            { name: "Bcrypt", prefix: ["$2a$", "$2y$", "$2b$", "$2x$"] },
            { name: "SHA-256-Crypt ($5$)", prefix: "$5$" },
            { name: "SHA-512-Crypt ($6$)", prefix: "$6$" },
            { name: "Argon2", prefix: ["$argon2id$", "$argon2i$", "$argon2d$"] },
            { name: "Sun MD5-Crypt", prefix: "$md5$" },
            { name: "Descrypt (DES)", regex: /^[a-zA-Z0-9\/.]{13}$/ },
            { name: "BSDi Crypt", prefix: "_" },
            { name: "WordPress / PHPass", prefix: ["$P$", "$H$"] },
            { name: "Drupal 7", prefix: "$S$" },
            { name: "Django (PBKDF2)", prefix: "pbkdf2_sha256$" },
            { name: "Django (Argon2)", prefix: "argon2" },
            { name: "Magento 1.x", regex: /^[a-f0-9]{32}:[a-z0-9]+$/ },
            { name: "Apache APR MD5", prefix: "$apr1$" },
            { name: "MySQL 3.2.3", regex: /^[0-9a-fA-F]{16}$/ },
            { name: "MySQL 4.1+ / SHA-1", regex: /^\*[0-9A-F]{40}$/i }, 
            { name: "PostgreSQL (MD5)", prefix: "md5" },
            { name: "MSSQL 2000", regex: /^0x0100[0-9A-F]{88}$/i },
            { name: "MSSQL 2005", regex: /^0x0100[0-9A-F]{40}$/i },
            { name: "MSSQL 2012/2014", regex: /^0x0200[0-9A-F]{136}$/i },
            { name: "Oracle 7-10g", regex: /^[0-9A-F]{16}$/ },
            { name: "Oracle 11g", regex: /^S:[0-9A-F]{60}$/ },
            { name: "MongoDB", regex: /^[a-f0-9]{32}$/ },
            { name: "NTLMv1 / NetNTLMv1", prefix: "$NETNTLM$" },
            { name: "NTLMv2", regex: /^[a-f0-9]{32}:.+/i },
            { name: "Cisco-IOS (Type 4)", prefix: "$4$" },
            { name: "Cisco-IOS (Type 5)", prefix: "$1$" },
            { name: "Cisco-IOS (Type 7)", regex: /^(0[0-9]|1[0-5])[0-9a-fA-F]+$/ }, // FIXED REGEX
            { name: "Cisco-IOS (Type 8)", prefix: "$8$" },
            { name: "Cisco-IOS (Type 9)", prefix: "$9$" },
            { name: "PDF 1.4-1.6", prefix: "$pdf$" },
            { name: "Office 2007", prefix: "$office$*2007" },
            { name: "Office 2010", prefix: "$office$*2010" },
            { name: "Office 2013", prefix: "$office$*2013" },
            { name: "WinZip", prefix: "$zip2$" },
            { name: "7-Zip", prefix: "$7z$" },
            { name: "RAR5", prefix: "$rar5$" },
            { name: "MD5 / NTLM / MD4", length: 32, regex: /^[0-9a-fA-F]{32}$/i },
            { name: "SHA-1 / MySQL4+", length: 40, regex: /^[0-9a-fA-F]{40}$/i },
            { name: "SHA-224", length: 56, regex: /^[0-9a-fA-F]{56}$/i },
            { name: "SHA-256", length: 64, regex: /^[0-9a-fA-F]{64}$/i },
            { name: "SHA-384", length: 96, regex: /^[0-9a-fA-F]{96}$/i },
            { name: "SHA-512 / Whirlpool", length: 128, regex: /^[0-9a-fA-F]{128}$/i },
            { name: "RIPEMD-160", length: 40, regex: /^[0-9a-fA-F]{40}$/i },
            { name: "CRC-32", length: 8, regex: /^[0-9a-fA-F]{8}$/i }
        ];

        const hashInput = document.getElementById('hashInput');
        const consoleOutput = document.getElementById('consoleOutput');
        const btnAnalyze = document.getElementById('btnAnalyze');
        const btnDownload = document.getElementById('btnDownload');
        let analysisLog = ""; 

        btnAnalyze.addEventListener('click', () => {
            const rawText = hashInput.value.trim();
            if (!rawText) return;

            const lines = rawText.split(/\r?\n/);
            consoleOutput.innerHTML = ""; 
            analysisLog = "SHADOWBORNE // HASH ANALYSIS REPORT\nDATE: " + new Date().toLocaleString() + "\n----------------------------------------\n";
            let count = 0;

            lines.forEach((line, index) => {
                line = line.trim();
                if (!line) return; 
                count++;
                let matches = [];
                
                HASH_LIB.forEach(rule => {
                    let isMatch = false;
                    if (rule.prefix) {
                        if (Array.isArray(rule.prefix)) {
                            if (rule.prefix.some(p => line.startsWith(p))) isMatch = true;
                        } else {
                            if (line.startsWith(rule.prefix)) isMatch = true;
                        }
                    }
                    else if (rule.regex) {
                        if (rule.regex.test(line)) isMatch = true;
                    }
                    else if (rule.length && line.length === rule.length) {
                        isMatch = true;
                    }
                    if (isMatch) matches.push(rule.name);
                });

                const lineNum = (index + 1).toString().padStart(2, '0');
                const truncatedHash = line.length > 25 ? line.substring(0, 25) + "..." : line;
                let resultHTML = "";
                let logResult = "";

                if (matches.length > 0) {
                    const uniqueMatches = [...new Set(matches)]; 
                    resultHTML = `<div class="border-b border-gray-800 pb-1 mb-1 hover:bg-white/5 transition-colors">
                        <span class="text-gray-500">[${lineNum}]</span> 
                        <span class="text-gray-400">${truncatedHash}</span> 
                        <span class="text-[#00f3ff]"> >> ${uniqueMatches.join(' OR ')}</span>
                    </div>`;
                    logResult = `[${lineNum}] ${line} >> DETECTED: ${uniqueMatches.join(' OR ')}`;
                } else {
                    resultHTML = `<div class="border-b border-gray-800 pb-1 mb-1 opacity-50 hover:opacity-100 transition-opacity">
                        <span class="text-gray-500">[${lineNum}]</span> 
                        <span class="text-gray-600">${truncatedHash}</span> 
                        <span class="text-[#ff003c]"> >> UNKNOWN_FORMAT</span>
                    </div>`;
                    logResult = `[${lineNum}] ${line} >> UNKNOWN_FORMAT`;
                }
                consoleOutput.innerHTML += resultHTML;
                analysisLog += logResult + "\n";
            });
            if (count > 0) btnDownload.classList.remove('hidden');
        });

        btnDownload.addEventListener('click', () => {
            const blob = new Blob([analysisLog], { type: "text/plain" });
            const url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.href = url;
            a.download = "SHADOWBORNE_HASH_REPORT.txt";
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        });

        const btnGenerate = document.getElementById('btnGenerate');
        const argonInput = document.getElementById('argonInput');
        const argonOutput = document.getElementById('argonOutput');
        const argonResult = document.getElementById('argonResult');

        btnGenerate.addEventListener('click', async () => {
            const password = argonInput.value;
            if (!password) return;
            btnGenerate.innerText = "CALCULATING...";
            btnGenerate.classList.add("opacity-50", "cursor-wait");

            try {
                const hash = await argon2.hash({
                    pass: password,
                    salt: 'shadowbornesalt123',
                    time: 4,
                    mem: 65536,
                    hashLen: 32,
                    parallelism: 4,
                    type: argon2.ArgonType.Argon2id
                });
                argonOutput.value = hash.encoded;
                argonResult.classList.remove('hidden');
                btnGenerate.innerText = "EXECUTE_HASHING_ALGORITHM";
                btnGenerate.classList.remove("opacity-50", "cursor-wait");
            } catch (e) {
                console.error(e);
                argonOutput.value = "ERROR: WASM_FAILURE // " + e.message;
                btnGenerate.innerText = "EXECUTE_HASHING_ALGORITHM";
            }
        });
    </script>
</body>
</html>